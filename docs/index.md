<html lang="en-us"><head>
  <meta charset="UTF-8">
  <title> Style Transfer for Co-Speech Gesture Animation: A Multi-Speaker Conditional-Mixture Approach by chahuja</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
  <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  <link href="style2.css" rel="stylesheet">
  
  <link href="style.css" rel="stylesheet">
</head>
<body style="background-color: white;">
  <section class="page-header">
    <h1 class="project-name" style="font-size: 2.4rem"> Style Transfer for Co-Speech Gesture Animation: <br>A Multi-Speaker Conditional-Mixture Approach</h1>
    <h2 class="project-tagline"><a href="http://chahuja.com">Chaitanya Ahuja</a>, Dong Won Lee, Yukiko I. Nakano, <a href="https://www.cs.cmu.edu/~morency/">Louis-Philippe Morency</a></h2>
    <h2 class="project-tagline">ECCV 2020</h2>
    <!-- <a href="https://github.com/chahuja/mix-stage" class="btn">View on GitHub</a>
    <a href="https://github.com/chahuja/mix-stage/zipball/master" class="btn">Download .zip</a>
    <a href="https://github.com/chahuja/mix-stage/tarball/master" class="btn">Download .tar.gz</a> -->
  </section>
  
  <section id="main-content" class="main-content" style="max-width: 75rem; min-width: 75rem; font-size: 0.9rem; background-color: white;">
    <h1>Abstract</h1>
    How can we teach robots or virtual assistants to gesture naturally? Can we go further and adapt the gesturing style to follow a specific speaker? Gestures that are naturally timed with corresponding speech during human communication are called co-speech gestures. A key challenge, called gesture style transfer, is to learn a model that generates these gestures for a speaking agent 'A' in the gesturing style of a target speaker 'B'. A secondary goal is to simultaneously learn to generate co-speech gestures for multiple speakers while remembering what is unique about each speaker. We call this challenge style preservation. In this paper, we propose a new model, named Mix-StAGE, which trains a single model for multiple speakers while learning unique style embeddings for each speaker's gestures in an end-to-end manner. A novelty of Mix-StAGE is to learn a mixture of generative models which allows for conditioning on the unique gesture style of each speaker. As Mix-StAGE disentangles style and content of gestures, gesturing styles for the same input speech can be altered by simply switching the style embeddings. Mix-StAGE also allows for style preservation when learning simultaneously from multiple speakers. We also introduce a new dataset, Pose-Audio-Transcript-Style (PATS), designed to study gesture generation and style transfer. Our proposed Mix-StAGE model significantly outperforms the previous state-of-the-art approach for gesture generation and provides a path towards performing gesture style transfer across multiple speakers. 
    <h2 style="color:black; text-align:center"><a href="https://arxiv.org/abs/2007.12553">[paper]</a> <a href="https://github.com/chahuja/mix-stage">[code]</a> <a href="https://github.com/chahuja/pats">[dataset]</a></h2>
    <h1> Demo </h1>
    <p> <b> Navigating this demo:</b> The top left represents the style space of all the speakers in our pretrained model. 
      On the top right you will view can view the videos for both <b>Style Transfer</b> and <b>Style Preservation</b>. 
      Both the animations are generated by our model. The grid bottom can take you through all the styles in the model. 
      For example, if you choose <i>'lec_cosmic'</i> as the style and the <i>'0'th</i> audio in the <i>'maher'</i> column, the generated animation will be in the style of <i>'lec_cosmic'</i> but with the audio of <i>'maher'</i>. 
      You can choose from any style and any audio listed in the grid. 
      There are 7 different audios and 8 different styles to choose from.</p>
      <div class="img-container">      
        <img id="annotimage" class="img-fluid annotimage" src="figs/gesture_space_8sp_annotated.png" style="width: 510px; height: 390px">
        <!-- <div id="drawing" class="drawing-class">
          <svg id="SvgjsSvg1371" width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" viewBox="0 0 454 395.56" class="segmentation">
            <defs id="SvgjsDefs1372"></defs>
            <polygon id="SvgjsPolygon1373" points="0,0 100,0 0,100 0,0" fill-opacity="0.7" fill="#e1b9be" stroke-opacity="0.7" stroke="#e1b9be" stroke-width="1"></polygon>
          </svg> -->
        </div>
      
      
      <div class="video-container">
        <p id="vid2" style="text-align: center; font-size: 1.6rem">Style Preservation</p>
        <p id="vid2style" style="text-align: center;">Style:</p>
        <p id="vid2audio" style="text-align: center;">Audio:</p>
        <div class="container">
          <video id="video2" width="420">
            <source id="src2" src="" type="video/mp4">
              Your browser does not support HTML video.
            </video>
          </div>
        </div>
        <div class="video-container">
          <p id="vid1" style="text-align: center; font-size: 1.6rem">Style Transfer</p>
          <p id="vid1style" style="text-align: center;">Style:</p>
          <p id="vid1audio" style="text-align: center;">Audio:</p>
          <div class="container">
            <video id="video1" width="420">
              <source id="src1" src="" type="video/mp4">
                Your browser does not support HTML video.
              </video>
            </div>
          </div>
          
          <ul class="donate-now" id="style" ,="" style="min-width: 65rem; max-width: 65rem;">
            <li><p name="style" style="text-align: center; font-size: 1.8rem;">Style</p></li>
          <li><input type="radio" id="0" name="style" onclick="updateVideo(0, 'ytch_prof')"><label for="0">ytch_prof</label></li><li><input type="radio" id="1" name="style" onclick="updateVideo(0, 'oliver')"><label for="1">oliver</label></li><li><input type="radio" id="2" name="style" onclick="updateVideo(0, 'noah')"><label for="2">noah</label></li><li><input type="radio" id="3" name="style" onclick="updateVideo(0, 'maher')"><label for="3">maher</label></li><li><input type="radio" id="4" name="style" onclick="updateVideo(0, 'lec_evol')"><label for="4">lec_evol</label></li><li><input type="radio" id="5" name="style" onclick="updateVideo(0, 'lec_cosmic')"><label for="5">lec_cosmic</label></li><li><input type="radio" id="6" name="style" onclick="updateVideo(0, 'ellen')"><label for="6">ellen</label></li><li><input type="radio" id="7" name="style" onclick="updateVideo(0, 'corden')"><label for="7">corden</label></li></ul>
          <br><br>
          <hr width="940" style="border-bottom: 2px solid black;">
          <div id="audio"><ul class="donate-now" id="audio-0" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-0</p></li><li><input type="radio" id="audio-00" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031851.mp4')"><label for="audio-00">0</label></li><li><input type="radio" id="audio-01" name="audio" onclick="updateVideo(1, 'oliver', '101092.mp4')"><label for="audio-01">0</label></li><li><input type="radio" id="audio-02" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000041967.mp4')"><label for="audio-02">0</label></li><li><input type="radio" id="audio-03" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001606.mp4')"><label for="audio-03">0</label></li><li><input type="radio" id="audio-04" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022604.mp4')"><label for="audio-04">0</label></li><li><input type="radio" id="audio-05" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006491.mp4')"><label for="audio-05">0</label></li><li><input type="radio" id="audio-06" name="audio" onclick="updateVideo(1, 'ellen', '106701.mp4')"><label for="audio-06">0</label></li><li><input type="radio" id="audio-07" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021312.mp4')"><label for="audio-07">0</label></li></ul><ul class="donate-now" id="audio-1" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-1</p></li><li><input type="radio" id="audio-10" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031858.mp4')"><label for="audio-10">1</label></li><li><input type="radio" id="audio-11" name="audio" onclick="updateVideo(1, 'oliver', '101097.mp4')"><label for="audio-11">1</label></li><li><input type="radio" id="audio-12" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000041974.mp4')"><label for="audio-12">1</label></li><li><input type="radio" id="audio-13" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001614.mp4')"><label for="audio-13">1</label></li><li><input type="radio" id="audio-14" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022620.mp4')"><label for="audio-14">1</label></li><li><input type="radio" id="audio-15" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006492.mp4')"><label for="audio-15">1</label></li><li><input type="radio" id="audio-16" name="audio" onclick="updateVideo(1, 'ellen', '107329.mp4')"><label for="audio-16">1</label></li><li><input type="radio" id="audio-17" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021323.mp4')"><label for="audio-17">1</label></li></ul><ul class="donate-now" id="audio-2" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-2</p></li><li><input type="radio" id="audio-20" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031859.mp4')"><label for="audio-20">2</label></li><li><input type="radio" id="audio-21" name="audio" onclick="updateVideo(1, 'oliver', '101240.mp4')"><label for="audio-21">2</label></li><li><input type="radio" id="audio-22" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000041975.mp4')"><label for="audio-22">2</label></li><li><input type="radio" id="audio-23" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001616.mp4')"><label for="audio-23">2</label></li><li><input type="radio" id="audio-24" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022628.mp4')"><label for="audio-24">2</label></li><li><input type="radio" id="audio-25" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006494.mp4')"><label for="audio-25">2</label></li><li><input type="radio" id="audio-26" name="audio" onclick="updateVideo(1, 'ellen', '107527.mp4')"><label for="audio-26">2</label></li><li><input type="radio" id="audio-27" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021324.mp4')"><label for="audio-27">2</label></li></ul><ul class="donate-now" id="audio-3" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-3</p></li><li><input type="radio" id="audio-30" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031864.mp4')"><label for="audio-30">3</label></li><li><input type="radio" id="audio-31" name="audio" onclick="updateVideo(1, 'oliver', '101296.mp4')"><label for="audio-31">3</label></li><li><input type="radio" id="audio-32" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000041982.mp4')"><label for="audio-32">3</label></li><li><input type="radio" id="audio-33" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001621.mp4')"><label for="audio-33">3</label></li><li><input type="radio" id="audio-34" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022659.mp4')"><label for="audio-34">3</label></li><li><input type="radio" id="audio-35" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006495.mp4')"><label for="audio-35">3</label></li><li><input type="radio" id="audio-36" name="audio" onclick="updateVideo(1, 'ellen', '107762.mp4')"><label for="audio-36">3</label></li><li><input type="radio" id="audio-37" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021335.mp4')"><label for="audio-37">3</label></li></ul><ul class="donate-now" id="audio-4" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-4</p></li><li><input type="radio" id="audio-40" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031867.mp4')"><label for="audio-40">4</label></li><li><input type="radio" id="audio-41" name="audio" onclick="updateVideo(1, 'oliver', '101297.mp4')"><label for="audio-41">4</label></li><li><input type="radio" id="audio-42" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000041986.mp4')"><label for="audio-42">4</label></li><li><input type="radio" id="audio-43" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001625.mp4')"><label for="audio-43">4</label></li><li><input type="radio" id="audio-44" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022667.mp4')"><label for="audio-44">4</label></li><li><input type="radio" id="audio-45" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006496.mp4')"><label for="audio-45">4</label></li><li><input type="radio" id="audio-46" name="audio" onclick="updateVideo(1, 'ellen', '107938.mp4')"><label for="audio-46">4</label></li><li><input type="radio" id="audio-47" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021340.mp4')"><label for="audio-47">4</label></li></ul><ul class="donate-now" id="audio-5" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-5</p></li><li><input type="radio" id="audio-50" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031874.mp4')"><label for="audio-50">5</label></li><li><input type="radio" id="audio-51" name="audio" onclick="updateVideo(1, 'oliver', '101338.mp4')"><label for="audio-51">5</label></li><li><input type="radio" id="audio-52" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000042006.mp4')"><label for="audio-52">5</label></li><li><input type="radio" id="audio-53" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001640.mp4')"><label for="audio-53">5</label></li><li><input type="radio" id="audio-54" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022727.mp4')"><label for="audio-54">5</label></li><li><input type="radio" id="audio-55" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006497.mp4')"><label for="audio-55">5</label></li><li><input type="radio" id="audio-56" name="audio" onclick="updateVideo(1, 'ellen', '108251.mp4')"><label for="audio-56">5</label></li><li><input type="radio" id="audio-57" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021348.mp4')"><label for="audio-57">5</label></li></ul><ul class="donate-now" id="audio-6" style="min-width: 65rem; max-width: 65rem;"><li><p name="audio" style="text-align: center; font-size: 1.6rem;">Audio-6</p></li><li><input type="radio" id="audio-60" name="audio" onclick="updateVideo(1, 'ytch_prof', 'cmu0000031877.mp4')"><label for="audio-60">6</label></li><li><input type="radio" id="audio-61" name="audio" onclick="updateVideo(1, 'oliver', '101613.mp4')"><label for="audio-61">6</label></li><li><input type="radio" id="audio-62" name="audio" onclick="updateVideo(1, 'noah', 'cmu0000042014.mp4')"><label for="audio-62">6</label></li><li><input type="radio" id="audio-63" name="audio" onclick="updateVideo(1, 'maher', 'cmu0000001655.mp4')"><label for="audio-63">6</label></li><li><input type="radio" id="audio-64" name="audio" onclick="updateVideo(1, 'lec_evol', 'cmu0000022731.mp4')"><label for="audio-64">6</label></li><li><input type="radio" id="audio-65" name="audio" onclick="updateVideo(1, 'lec_cosmic', 'cmu0000006498.mp4')"><label for="audio-65">6</label></li><li><input type="radio" id="audio-66" name="audio" onclick="updateVideo(1, 'ellen', '109382.mp4')"><label for="audio-66">6</label></li><li><input type="radio" id="audio-67" name="audio" onclick="updateVideo(1, 'corden', 'cmu0000021352.mp4')"><label for="audio-67">6</label></li></ul></div>
          <hr width="940" style="border-bottom: 2px solid white;">
          <br>
          <br>

          <h1> Media Coverage</h1>
          <p align="center">
            <a href="https://techxplore.com/news/2020-08-mix-stage-gestures-accompany-virtual-agent.html" target="_blank"><img src="figs/logo_techxplore.png" width="200"></a>
            
        </p>
          <h1> Acknowledgements </h1>
          <p align="left">
            This material is based upon work partially supported by the National Science Foundation (Awards #1750439 #1722822), National Institutes of Health and the InMind project. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of National Science Foundation or National Institutes of Health, and no official endorsement should be inferred.
          </p>

          <hr width="940" style="border-bottom: 2px solid black;">
          <footer class="site-footer">
            <span class="site-footer-owner"><a href="https://github.com/chahuja/mix-stage"> Style Transfer for Co-Speech Gesture Animation: A Multi-Speaker Conditional-Mixture Approach</a> is maintained by <a href="https://github.com/chahuja">chahuja</a>.</span>
            
            <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
          </footer>
          
        <iframe id="speakers" class="hidden">




<meta charset="utf-8">
<meta name="google" value="notranslate">



# PATS (Pose, Audio, Transcript, Style) Dataset

<img src="https://user-images.githubusercontent.com/43928520/90432137-1cbcaf80-e098-11ea-8491-0f7c92da4b29.png" width="100" height="100">

## Overview of PATS
* Contains transcribed language, audio, pose data (3 features)
* 251 hours of data (Mean: 10.7s, Standard Deviation: 13.5s)
* 425 Speakers (including 10 speakers from [Ginosar, et al.](https://people.eecs.berkeley.edu/~shiry/projects/speech2gesture/index.html) )
* 15 talk show hosts, 5 lecturers, 3 YouTubers, and 2 televangelists.
* Includes various representations of features/


## Dataset Features
| Features | Available Representations | Description |
| :---: | :---: | :---: |
| Audio | Log-mel Spectrograms | Audio directly scraped from Youtube |
| Language | BERT, Word2Vec | Transcript derived from Google ASR, WER = 0.29, Bert uses [HuggingFace](https://huggingface.co/transformers/model_doc/bert.html) |
| Gestures | OpenPose Skeletal Keypoints | [OpenPose](https://github.com/CMU-Perceptual-Computing-Lab/openpose) |



## Table of Contents
1. [Link to data](#Link-to-data)
2. [Requirements](#Requirements)
3. [Example Script](#Examples)
4. [Reference](#Reference)


## Link to data:
Data can be downloaded here : LINK HERE\
We've also included a csv file, in which you can see the video source and the specific section we took the intervals from.


## Requirements:

## Examples

Arguments:
- path2data (str): path to dataset.
- speaker (str): speaker name.
- modalities (list of str): list of modalities to wrap in the dataloader. These modalities are keys of the hdf5 files which were preprocessed earlier (default: ``['pose/data', 'audio/log_mel']``)
- fs_new (list, optional): new frequency of modalities, to which the data is up/downsampled to. (default: ``[15, 15]``).
- time (float, optional): time snippet length in seconds. (default: ``4.3``).
- split (tuple or None, optional): split fraction of train and dev sets. Must add up to less than 1. If ``None``, use ``dataset`` columns in the master dataframe (loaded in self.df) to decide train, dev and test split. (default: ``None``).
- batch_size (int, optional): batch size of the dataloader. (default: ``100``).
- shuffle (boolean, optional): set to ``True`` to have the data reshuffled at every epoch (default: ``False``).
- num_workers (int, optional): set to values >0 to have more workers to load the data. argument for torch.utils.data.DataLoader. (default: ``15``). 
- window_hop
-load_data
- style_iters
- num_training_sample
- nample_all_styles
- repeat_text
- quantile_sample
- quantile_num_training_sample
- weighted
- filler

```markdown
from data.dataUtils import Data 
data = Data('../path/to/data/', 'oliver', ['pose/data', 'audio/log_mel_512', 'text/bert']

for batch in data.train:
    break
    print(batch).
```

### Reference
If you found this dataset helpful, please cite the following paper:

```
@misc{ahuja2020style,
    title={Style Transfer for Co-Speech Gesture Animation: A Multi-Speaker Conditional-Mixture Approach},
    author={Chaitanya Ahuja and Dong Won Lee and Yukiko I. Nakano and Louis-Philippe Morency},
    year={2020},
    eprint={2007.12553},
    archivePrefix={arXiv},
    primaryClass={cs.CV}
}
```
